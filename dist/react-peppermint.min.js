!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("react-peppermint",[],e):"object"==typeof exports?exports["react-peppermint"]=e():t["react-peppermint"]=e()}(this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=require("react")},function(t,e,n){"use strict";function r(t,e,n){return t[e]=n}function o(t,e){return t[e]}n.r(e);var i,c=Symbol("REACT-PEPPERMINT.VM_CONTEXT"),u=Symbol("REACT-PEPPERMINT.VM_CLASS_INFO");function s(t,e){for(var n={};t.constructor!==Object;){var r=Object.getOwnPropertyDescriptors(t);if(e&&e.length){for(var o={},c=0,u=Object.keys(r);c<u.length;c++)for(var s=u[c],f=0,p=e;f<p.length;f++){var v=p[f],l=!1;switch(v){case i.None:break;case i.Field:l="function"!=typeof r[s].value&&"function"!=typeof r[s].get;break;case i.Property:l="function"==typeof r[s].get;break;case i.Method:l="function"==typeof r[s].value&&"function"!=typeof r[s].get;break;default:throw new Error("Property flag not supported: "+v)}l&&(o[s]=r[s])}r=o}n=Object.assign(r,n),t=a(t)}return n.constructor&&delete n.constructor,n}function f(t,e){if(t&&t.constructor){var n=t.constructor;return function(t){return"symbol"==typeof t||t instanceof Symbol}(e)&&Object.getOwnPropertySymbols(n).includes(e)?n[e]:"string"==typeof e&&Object.getOwnPropertyNames(n).includes(e)?n[e]:void 0}}function a(t){if("object"==typeof t)return Object.getPrototypeOf(t);if("function"==typeof t)return t.prototype;throw new Error("Expected an object or a function. Got: "+t)}function p(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if("function"==typeof t)return t.apply(void 0,e)}!function(t){t.None="None",t.Field="Field",t.Property="Property",t.Method="Method"}(i||(i={}));var v=function(){function t(){this.activate={},this.deactivate={},this.actions={},this.broadcasts={}}return t.getInfo=function(e){if(e){var n=t.getOwnInfo(e);return n||(t.getBaseInfo(e)?t.initInfo(e):void 0)}},t.getOrInitInfo=function(e){var n=t.getInfo(e);return n||t.initInfo(e)},t.getOwnInfo=function(t){return"object"==typeof t?f(t,u):function(t,e){return Object.getOwnPropertySymbols(t).includes(e)&&o(t,e)}(t,u)},t.getBaseInfo=function(t){return"object"==typeof t?function(t,e){if(t&&t.constructor)return t.constructor[e]}(t,u):o(t,u)},t.initInfo=function(e){var n="function"==typeof e?e:e.constructor,i=o(n,u),c=Object.assign(new t,i);return r(n,u,c)},t}(),l=function(){return function(t){this.immediate=!1,Object.assign(this,t)}}();function h(t){return function(t,n){if(!n)return function(n,r){return e(n,r,t)};e.call(void 0,t,n)};function e(e,n,r){v.getOrInitInfo(e)[t][n]=new l(r)}}var d=h("actions"),y=h("activate"),g=h("broadcasts"),w=h("deactivate");function b(t){v.getOrInitInfo(t)}var m=n(0),O=m.createContext(void 0),j=O.Provider,M=O.Consumer;function P(t,e,n,r){return{vm:t,methodName:e,methodArgs:n,isBroadcast:r}}var V,I=function(){function t(t){this.viewsByViewModel=new Map,this.allViews=[],this.allViews.push(t)}return t.prototype.registerView=function(t,e){var n=this.viewsByViewModel.get(t);n||(n=new Set,this.viewsByViewModel.set(t,n)),n.add(e),this.allViews.push(e)},t.prototype.unregisterView=function(t,e){var n=this.viewsByViewModel.get(t);n.delete(e),n.size||this.viewsByViewModel.delete(t),function(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return t.splice(n,1)[0]}(this.allViews,e)},t.prototype.refreshViews=function(t,e){var n;(n=t?this.allViews.slice():this.viewsByViewModel.get(e))&&n.forEach(function(t){t.forceUpdate()})},t}(),_=function(){function t(t,e,n){this.activate={},this.deactivate={},this.activate=e.activate,this.deactivate=e.deactivate,this.registerView=function(e){return n.registerView(t,e)},this.unregisterView=function(e){return n.unregisterView(t,e)}}return t.getContext=function(t){if(t)return o(t,c)},t.initContext=function(e,n,o){var i=new t(e,n,o);return r(e,c,i)},t}(),k=function(){function t(t,e){this.internalResolver=t,this.viewRefresher=new I(e)}return t.prototype.get=function(t){var e=this.internalResolver.get(t),n=v.getInfo(e);n&&(_.getContext(e)||this.patchViewModel(e,n));return e},t.prototype.patchViewModel=function(t,e){_.initContext(t,e,this.viewRefresher),function(t,e,n){for(var r=s(e,n),o=0,i=Object.keys(r);o<i.length;o++){var c=i[o];Object.defineProperty(t,c,r[c])}}(t,t,[i.Property]);for(var n=function(t,e){void 0===e&&(e=!1);for(var n=s(t,[i.Method]),r={},o=0,c=Object.keys(n);o<c.length;o++){var u=c[o];r[u]=n[u].value,e&&(r[u]=r[u].bind(t))}return r}(t),r=0,o=Object.keys(n);r<o.length;r++){var c=o[r];this.patchMethod(t,e,c)}},t.prototype.patchMethod=function(t,e,n){var r,o=this,i=t[n],c=e.actions[n],u=e.broadcasts[n],s=e.activate[n],f=e.deactivate[n],a=c||u||s||f;r=!!a?function(){var e=arguments,r=!!u,c=P(t,n,e,r);p(o.onMethodInvokeStart,c);var s,v=i.apply(this,e),l=function(e){return f||o.viewRefresher.refreshViews(r,t),p(o.onMethodInvokeEnd,c),e};return(s=v)&&"function"==typeof s.then&&!a.immediate?v.then(l):l(v)}:i,t[n]=r.bind(t)},t}(),x=(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}V(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return x(e,t),e.prototype.render=function(){return this.setResolver(),m.createElement(j,{value:{resolver:this.vmResolver}},this.props.children)},e.prototype.setResolver=function(){this.props.resolver&&(this.vmResolver&&this.vmResolver.internalResolver===this.props.resolver||(this.vmResolver=new k(this.props.resolver,this),this.vmResolver.onMethodInvokeStart=this.props.onMethodInvokeStart,this.vmResolver.onMethodInvokeEnd=this.props.onMethodInvokeEnd))},e}(m.PureComponent),R=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},S=function(t){return function(e){var n=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return R(r,n),r.prototype.componentDidMount=function(){this.activate()},r.prototype.render=function(){var t=this;return m.createElement(M,null,function(n){t.init(n);var r=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=Object.assign.apply(Object,[t].concat(e));for(var r=0,o=e;r<o.length;r++)for(var i=o[r],c=Object.getPrototypeOf(i),u=0,s=Object.getOwnPropertyNames(c);u<s.length;u++){var f=s[u],a=Object.getOwnPropertyDescriptor(c,f);a&&"function"==typeof a.get&&(t[f]=a.get.call(i))}return t}({},t.vm,t.props);return m.createElement(e,C({},r))})},r.prototype.componentWillUnmount=function(){this.deactivate()},r.prototype.init=function(e){if(!this.vm){if(!e)throw new Error("Context not found. Make sure you use the Provider component.");if(!e.resolver)throw new Error("Resolver not found. Make sure you use the Provider component.");this.vm=e.resolver.get(t);var n=_.getContext(this.vm);if(!n)throw new Error("Class "+this.vm.constructor.name+" is used as a view-model but no decorator was used.");n.registerView(this)}},r.prototype.activate=function(){var t=_.getContext(this.vm);this.invokeMethods(Object.keys(t.activate||{}))},r.prototype.deactivate=function(){var t=_.getContext(this.vm);t.unregisterView(this),this.invokeMethods(Object.keys(t.deactivate||{}))},r.prototype.invokeMethods=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],o=this.vm[r];if("function"!=typeof o)return;o()}},r}(m.PureComponent),r=e.displayName||e.name||"Component";return n.displayName="WithViewModel("+r+")",n}};n.d(e,"action",function(){return d}),n.d(e,"activate",function(){return y}),n.d(e,"broadcast",function(){return g}),n.d(e,"deactivate",function(){return w}),n.d(e,"viewModel",function(){return b}),n.d(e,"Provider",function(){return E}),n.d(e,"withViewModel",function(){return S}),n.d(e,"ActionOptions",function(){return l}),n.d(e,"createMethodInvokeArgs",function(){return P})},function(t,e,n){t.exports=n(1)}])});